<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CyberSentinel | AI Security Platform</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark border-bottom border-secondary">
    <div class="container">
      <a class="navbar-brand text-info fw-bold" href="#">
        <i class="fas fa-shield-alt me-2"></i>CyberSentinel AI
      </a>
      <span class="badge bg-danger">SOC Analyst Mode</span>
    </div>
  </nav>

  <div class="container mt-4">
    <div class="row g-4">
      
      <div class="col-lg-5">
        <div class="card shadow-sm h-100 border-0 bg-dark-subtle">
          
          <div class="card-header bg-transparent border-0 pt-3">
             <ul class="nav nav-tabs card-header-tabs" id="inputTabs" role="tablist">
                <li class="nav-item">
                   <button class="nav-link active text-primary fw-bold" id="code-tab" data-bs-toggle="tab" data-bs-target="#code-pane" type="button">
                     <i class="fas fa-code me-2"></i>Source Code
                   </button>
                </li>
                <li class="nav-item">
                   <button class="nav-link text-warning fw-bold" id="binary-tab" data-bs-toggle="tab" data-bs-target="#binary-pane" type="button">
                     <i class="fas fa-file-binary me-2"></i>Binary File
                   </button>
                </li>
             </ul>
          </div>

          <div class="card-body">
            <div class="tab-content mb-3" id="inputTabContent">
                <div class="tab-pane fade show active" id="code-pane">
                    <textarea id="codeInput" class="form-control font-monospace bg-dark text-light border-secondary" rows="12"
                      placeholder="Paste suspicious script (Python, PowerShell, Bash, etc.) here..."></textarea>
                </div>

                <div class="tab-pane fade" id="binary-pane">
                    <div class="border border-secondary border-dashed rounded p-5 text-center bg-dark" id="dropZone" style="height: 310px; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                       <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                       <h5 class="text-light">Drag & Drop File</h5>
                       <p class="text-secondary small">Supports .EXE, .DLL, .SYS</p>
                       <input type="file" id="fileInput" class="form-control bg-secondary text-light w-75 mt-2">
                    </div>
                </div>
            </div>
            
            <div class="d-flex gap-2 mb-3">
                <button id="analyzeBtn" class="btn btn-primary flex-grow-1 fw-bold">
                    <i class="fas fa-search me-2"></i>Analyze Threat
                </button>
                <button id="deobfuscateBtn" class="btn btn-outline-warning" title="Attempt De-obfuscation">
                    <i class="fas fa-unlock"></i>
                </button>
            </div>

            <div class="card border-secondary bg-dark mt-4">
    <div class="card-header border-secondary py-1 d-flex justify-content-between align-items-center">
        <small class="text-info"><i class="fas fa-robot me-1"></i>CyberSentinel AI Assistant</small>
        <small class="text-muted" style="font-size: 0.7rem;">Powered by CyberSentinel</small>
    </div>
    
    <div class="card-body p-3" style="height: 400px; overflow-y: auto; background: rgba(0,0,0,0.1);" id="chatHistory">
        <div class="text-muted small text-center mt-5">
            <i class="fas fa-shield-alt fa-2x mb-2 d-block opacity-50"></i>
            Analyze code first, then ask technical questions...
        </div>
    </div>

    <div class="card-footer border-secondary p-2">
        <div class="d-flex align-items-end gap-2 bg-black rounded p-1" style="border: 1px solid #444;">
            <textarea id="chatInput" 
                      class="form-control form-control-sm bg-transparent text-light border-0 shadow-none" 
                      placeholder="Type a question... (Shift+Enter for new line)" 
                      rows="1" 
                      style="resize: none; max-height: 150px; overflow-y: auto;"></textarea>
            
            <button id="sendChatBtn" class="btn btn-sm btn-outline-info border-0 mb-1">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
</div>
                

      <div class="col-lg-7">
        <div id="loadingSpinner" class="text-center d-none py-5">
          <div class="spinner-border text-info" role="status"></div>
          <p class="mt-2 text-info">Decrypting & Analyzing...</p>
        </div>

        <div id="resultsSection" class="d-none">
          <div class="d-flex justify-content-end mb-3 gap-2">
            <button id="pdfBtn" class="btn btn-sm btn-outline-light"><i class="fas fa-file-pdf me-1"></i>Export Report</button>
            <button id="vtBtn" class="btn btn-sm btn-outline-success"><i class="fas fa-globe me-1"></i>Check VirusTotal</button>
          </div>

          <div class="row g-3 mb-3">
             <div class="col-md-5">
                <div class="card h-100 border-0 bg-dark-subtle">
                    <div class="card-body text-center d-flex flex-column justify-content-center">
                        <h6 class="text-muted">Threat Score</h6>
                        <h1 class="display-3 fw-bold" id="riskScoreDisplay">0</h1>
                        <span id="malwareTypeLabel" class="badge bg-secondary fs-6">Unknown</span>
                    </div>
                </div>
             </div>
             <div class="col-md-7">
                <div class="card h-100 border-0 bg-dark-subtle">
                    <div class="card-body p-2">
                        <canvas id="attackChart"></canvas>
                    </div>
                </div>
             </div>
          </div>

          <div class="card border-0 bg-dark-subtle">
            <div class="card-header bg-transparent">
              <h5 class="mb-0 text-info"><i class="fas fa-file-medical-alt me-2"></i>Analyst Report</h5>
            </div>
            <div class="card-body">
                <div id="behaviorsList" class="mb-3"></div>
                <div id="aiExplanation" class="ai-output text-light small"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="app.js"></script>
</body>
</html>